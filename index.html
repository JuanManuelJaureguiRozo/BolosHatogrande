<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Bolos Hatogrande</title>
</head>
<body>
  <h1>Resultados Torneos</h1>
  <label for="torneo">Selecciona torneo:</label>
  <select id="torneo">
    <option value="Ternas2025">Abril 2025</option>
  </select>

  <div id="tabla-resultados"></div>

  <script>
    const sheetKey = '1YTHfNJv9CCpqcy8hUXLRrY-cMmMwQJE5IA_K-ZRZCr0';

    function cargarDatos(tabName) {
      Tabletop.init({
        key: sheetKey,
        simpleSheet: false,
        callback: function(data) {
          const hoja = data[tabName].elements;
          mostrarTabla(hoja);
        }
      });
    }

    function mostrarTabla(data) {
      let html = '<table border="1"><thead><tr>';
      const headers = Object.keys(data[0]);
      headers.forEach(h => html += `<th>${h}</th>`);
      html += '</tr></thead><tbody>';

      data.forEach(row => {
        html += '<tr>';
        headers.forEach(h => html += `<td>${row[h]}</td>`);
        html += '</tr>';
      });

      html += '</tbody></table>';
      document.getElementById('tabla-resultados').innerHTML = html;
    }

    document.getElementById('torneo').addEventListener('change', e => {
      cargarDatos(e.target.value);
    });

    // Load default
    window.onload = () => cargarDatos(document.getElementById('torneo').value);
  </script>
</body>
</html>